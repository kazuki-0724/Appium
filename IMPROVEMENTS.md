# Appiumプロジェクト改善提案

このプロジェクトの現状を分析し、考えられる改善点と具体的なタスクを提案します。

### プロジェクトの現状評価

このプロジェクトは、Appiumを使ったUI自動テストの基本的な仕組みが整っている段階です。しかし、コードの保守性、再利用性、実行の自動化といった点で、より堅牢で効率的なプロジェクトにするための改善の余地が多くあります。

---

### 改善提案と具体的なタスク

優先度が高い順に提案します。

#### 1. 依存関係の管理 (最優先)

**問題点:** `requirements.txt` のような依存関係を定義するファイルがありません。これにより、他の環境でこのプロジェクトをセットアップする際に、どのライブラリ（Appiumクライアント、pytestなど）のどのバージョンを使えばよいか分からず、環境構築に失敗する可能性があります。

**タスク:**
*   `pip freeze > requirements.txt` コマンドを実行して、現在の環境で使っているライブラリとそのバージョンをリストアップした `requirements.txt` ファイルを作成します。
*   今後は、新しいライブラリを追加したらこのファイルを更新するようにします。

#### 2. `.gitignore` の設定

**問題点:** `__pycache__` や `.pytest_cache` といった、バージョン管理に含めるべきでないファイル/ディレクトリが含まれているようです。また、レポートやスクリーンショットもリポジトリを肥大化させる原因になります。

**タスク:**
*   プロジェクトのルートに `.gitignore` ファイルを作成（または編集）し、以下の内容を追記します。
    ```gitignore
    # Python
    __pycache__/
    *.pyc
    
    # Pytest
    .pytest_cache/
    
    # Reports
    reports/generated/
    reports/screenshot/
    reports/bk/
    
    # IDE / Editor
    .idea/
    .vscode/
    
    # Env file
    .env
    ```

#### 3. コードと設定の分離

**問題点:** Appiumサーバーのアドレス、テスト対象アプリのパス、ログイン情報などがテストコード内に直接書き込まれている（ハードコーディングされている）可能性があります。これでは、設定を変更するたびにコードを修正する必要があり、また、パスワードなどの機密情報をGitで管理してしまう危険性があります。

**タスク:**
*   `config.ini` や `.env` ファイルのような設定ファイルを作成し、URL、ユーザー名、パスワードなどの情報を外出しにします。
*   テストコードからは、これらの設定ファイルを読み込んで値を取得するように修正します。
*   作成した設定ファイルは `.gitignore` に追加し、Gitの管理対象外とします。

#### 4. コードのモジュール化と整理

**問題点:** `src/common/` や `src/test_case/` といったディレクトリがありますが、中身が空のようです。おそらく、主要なロジックが `appium_palapp_test.py` のような単一のファイルに集中していると推測されます。

**タスク:**
*   **共通処理の分離:** Appiumドライバーの起動・終了処理、要素を待機する処理、スクリーンショット撮影処理など、複数のテストケースで利用する処理を `src/common/` ディレクトリ内のファイルに切り出します。
*   **テストケースの分割:** `src/test_case/` ディレクトリ内に、`test_login.py`, `test_cart.py` のように、機能ごとにテストファイルを分割して作成し、可読性とメンテナンス性を向上させます。

#### 5. レポートとスクリーンショットの管理

**問題点:** `reports/screenshot/` 内に大量のスクリーンショットがフラットに保存されており、どのテスト実行時のものか判別が困難です。また、`reports/bk/` という手動バックアップは、Gitを使っていれば不要です。

**タスク:**
*   テスト実行ごとに、タイムスタンプ（例: `2025-06-28_10-30-00`）の付いたディレクトリを `reports/generated/` と `reports/screenshot/` の下に作成し、その中にレポートとスクリーンショットを保存するようにテストコードを修正します。
*   `reports/bk/` ディレクトリは、過去の重要なレポートを別の場所に保管した上で、Gitリポジトリから削除します。今後はGitのコミット履歴で管理します。

#### 6. CI/CDの導入

**問題点:** テストの実行が手動で行われているようです（`run_pytest_gui.py` の存在から推測）。

**タスク:**
*   GitHub ActionsのようなCI/CDツールを導入し、Gitへのプッシュなどをトリガーにして、自動でテストが実行される仕組みを構築します。
*   CI/CDパイプラインでは、`requirements.txt` に基づく環境構築 → テスト実行 → レポートの保存（Artifactsとして）という一連の流れを自動化します。
