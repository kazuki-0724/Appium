<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=800, initial-scale=1.0">
    <title>Auto Tester マニュアル</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body {
            background: linear-gradient(120deg, #232526 0%, #414345 100%);
            color: #f5f5f5;
            font-family: 'Meiryo', 'Yu Gothic', 'Segoe UI', sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background: #00adb5;
            color: #fff;
            padding: 32px 0 16px 0;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        header h1 {
            margin: 0;
            font-size: 2.4rem;
            letter-spacing: 0.1em;
        }
        main {
            max-width: 900px;
            margin: 32px auto 0 auto;
            background: rgba(34, 40, 49, 0.95);
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.12);
            padding: 32px 40px 24px 40px;
        }
        h2 {
            color: #ffd600;
            border-left: 6px solid #00adb5;
            padding-left: 12px;
            margin-top: 32px;
            margin-bottom: 16px;
            font-size: 1.4rem;
        }
        ul, ol {
            margin-left: 2em;
            margin-bottom: 1.5em;
        }
        li {
            margin-bottom: 0.5em;
        }
        code, pre {
            background: #393e46;
            color: #ffd600;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 1em;
        }
        pre {
            display: block;
            padding: 12px;
            margin: 12px 0;
            overflow-x: auto;
        }
        .note {
            background: #393e46;
            color: #ffd600;
            border-left: 4px solid #00adb5;
            padding: 10px 16px;
            margin: 18px 0;
            border-radius: 6px;
        }
        footer {
            text-align: center;
            color: #888;
            margin-top: 40px;
            font-size: 0.95rem;
        }
        @media (max-width: 900px) {
            main {
                padding: 16px 4vw;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>マニュアル</h1>
    </header>
    <main>
        <section>
            <h2>1. 環境準備</h2>
            <ul>
                <li><strong>必要なソフトウェア</strong>
                    <ul>
                        <li>Python（推奨: 3.8以上）</li>
                        <li>Appium（サーバー）</li>
                        <li>Appium Inspector（UI要素確認用）</li>
                        <li>Android SDK（adbコマンド利用のため）</li>
                    </ul>
                </li>
                <li><strong>必要なPythonパッケージのインストール</strong>
                    <pre><code>pip install Appium-Python-Client pytest beautifulsoup4</code></pre>
                </li>
            </ul>
        </section>
        <section>
            <h2>2. テストコードの仕組み</h2>
            <p>
                <strong>CommonCommand</strong>をベースクラスとして、基本操作（絶対座標・UI部品）を定義している<br>
                各テストケースはこれらの基本操作を組み合わせて実現している
            </p>
            <ul>
                <li>基本操作：絶対座標
                    <ul>
                        <li>タップ</li>
                        <li>長押し</li>
                        <li>スクロール</li>
                        <li>スワイプ</li>
                    </ul>
                </li>
                <li>基本操作：UI部品
                    <ul>
                        <li>ボタンクリック</li>
                        <li>テキスト入力</li>
                    </ul>
                </li>
            </ul>
        </section>
        <section>
            <h2>3. テスト実施概要</h2>
            <ol>
                <li>Appiumサーバを起動する</li>
                <li>DBなどの事前準備</li>
                <li>テストケースを実行する（実行中は基本的に放置でOK）</li>
                <li>実行結果からレポートを生成する</li>
                <li><strong>レポートを確認して、NGだったケースのみ人間の目で確認する</strong></strong></li>
            </ol>
        </section>
        <section>
            <h2>4. テストの準備</h2>
            <ul>
                <li>開発者オプションからUSBデバッグを有効化</li>
                <li>開発者オプションからUIデモモードを有効化（スクリーンショットの差分防止）</li>
                <li>すべての通知を停止させる（スクリーンショットの差分防止）</li>
                <li>テストに使用する組合員について、必要であればブロック別でデータの準備を行う</li>
                <li>
                    【test_1st_block】アプリを初期状態にする（クリーンインストール、データ削除など）<br>
                    【test_2nd_block】クリーンインストール後、ログイン済みの状態にする<br>
                </li>
            </ul>
        </section>
        <section>
            <h2>5. データの準備</h2>
            <ul>
                <li>【test_1st_block】必読モーダルを未読にする（チェック（有／無）両方未読にする）</li>
                <li>【test_1st_block】パルくる便プロモーションを未読にする</li>
                <li>【test_2nd_block】カゴを空にしておく</li>
                <li>【test_3rd_block】レコメンドモーダルを未読にする</li>
                <li>【test_3rd_block】カゴに注文番号「111」の商品を1つだけ追加しておく</li>
            </ul>
        </section>
        <section>
            <h2>6. テストの実行</h2>
            <ol>
                <li>Appiumサーバを起動する<br>
                    <pre><code>appium --allow-insecure=adb_shell</code></pre>
                </li>
                <li>pytestコマンドでテストケースを実行する(ブロック別に)
                    <pre><code>pytest -s appium_palapp_test.py -k test_1st_bloc</code></pre>
                    <pre><code>pytest -s appium_palapp_test.py -k test_2nd_bloc</code></pre>
                    <pre><code>pytest -s appium_palapp_test.py -k test_3rd_bloc</code></pre>
                    <pre><code>pytest -s appium_palapp_test.py -k test_4th_bloc</code></pre>
                </li>
                <li>【非推奨】GUIから実行する場合は以下のコマンド<br>
                    <pre><code>python run_pytest_gui.py</code></pre>
                </li>
            </ol>
        </section>
        <section>
            <h2>7. テストケースの個別実行</h2>
            <p>特定のテストメソッドのみ実行したい場合は、<code>-k</code>オプションを使う</p>
            <pre><code>pytest -s appium_palapp_test.py -k 実行したいテストのメソッド名</code></pre>
            <pre><code>pytest -s appium_palapp_test.py -k test_no_login_top</code></pre>
        </section>
        <section>
            <h2>8. テストの評価（画像比較レポート生成）</h2>
            <ol>
                <li>評価処理を実行する<br>
                    <pre><code>python image_similarity.py</code></pre>
                </li>
                <li>テスト結果の確認
                    <ul>
                        <li>各テストケースの結果は「reportN.html」にて確認可能</li>
                        <li>正しいテスト結果のスクリーンショットと実行結果のスクリーンショットをピクセル単位で比較した結果が出力される</li>
                    </ul>
                </li>
            </ol>
        </section>
        <section>
            <h2>9. 【非推奨】画面構成と使い方（GUIの場合）</h2>
            <ul>
                <li><strong>テストケース選択</strong>：右側のチェックボックスで実行したいテストを選択できます。</li>
                <li><strong>テスト実行</strong>：選択したテストのみを実行します。</li>
                <li><strong>レポート生成</strong>：画像比較によるレポートを生成します。</li>
                <li>実行したいテストケースにチェックを入れ、<strong>テスト実行</strong>ボタンをクリックしてください。</li>
                <li>テスト後、<strong>レポート生成</strong>ボタンで画像比較レポートを生成できます。</li>
                <li>レポートは <code>reports/generated/</code> フォルダにHTML形式で出力されます。</li>
            </ul>
        </section>
        <section>
            <h2>10. Appium Inspectorの使い方</h2>
            <ol>
                <li>Appium Inspectorを起動</li>
                <li>Desired Capabilitiesを入力（例: テストコードと同じ内容）</li>
                <li>「Start Session」をクリック</li>
                <li>画面上の要素をクリックしてIDやXPathを確認</li>
            </ol>
        </section>
        <section>
            <h2>注意事項</h2>
            <ul>
                <li>PyQt5やpytestなどの必要なライブラリがインストールされていることを確認</li>
                <li>レポート生成には画像ファイルが必要。テスト実行後に行うこと。</li>
            </ul>
            <div class="note">
                <strong>ヒント:</strong> テストやレポートの詳細は <a href="reports/generated/summary.html" style="color:#ffd600;">レポート概要</a> 
            </div>
        </section>
    </main>
</body>
</html>